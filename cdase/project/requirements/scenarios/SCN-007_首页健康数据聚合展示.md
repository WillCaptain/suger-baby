# Scenario: SCN-007 首页健康数据聚合展示

## 0. Metadata
- ID: SCN-007
- Steward: hangxiao
- Priority: P0
- Version: v0.1
- Last Updated: 2026-01-29
- Status: Draft
- Development Phase: 第三阶段（3周）

## 1. Background

**用户角色**: 糖尿病患者

**问题陈述**:
- 用户每天记录血糖、饮食、运动等数据，散落在各个模块
- 需要一个聚合视图，一屏查看今日健康状况
- 用户希望快速了解：血糖是否达标、饮食是否超标、是否完成运动目标
- 首页是用户最常访问的页面，必须简洁、信息丰富

## 2. Core Scenario

### 2.1 首页数据卡片展示
1. 用户打开应用，进入首页
2. **今日血糖卡片**：
   - 显示最新血糖值（如：6.5 mmol/L）
   - 显示测量类型和时间（如：餐后 10:30）
   - 血糖状态标识：
     - 绿色：正常（< 7.0）
     - 黄色：偏高（7.0 - 11.0）
     - 红色：危险（> 11.0）
   - 点击可进入血糖详情页
   
3. **今日饮食卡片**：
   - 显示今日总摄入热量（如：1500 / 2000 千卡）
   - 进度条显示摄入占比
   - 显示三大营养素占比（碳水/蛋白质/脂肪）
   - 点击可进入饮食详情页
   
4. **今日运动卡片**：
   - 显示今日运动时长（如：30 分钟）
   - 显示消耗热量（如：350 千卡）
   - 运动目标达成情况（如：已完成 60%）
   - 点击可进入运动详情页

### 2.2 快捷操作入口
5. 首页提供快捷按钮：
   - "记录血糖"
   - "记录饮食"
   - "记录运动"
   - "问诊徐医生"
6. 点击按钮直接进入对应功能

### 2.3 健康提醒
7. 首页显示智能提醒：
   - "距离上次测血糖已3小时，建议餐后测一次"
   - "今天还没记录早餐，点击记录吧"
   - "连续3天未运动，加油动起来！"
8. 提醒基于用户历史行为和时间规律

### 2.4 徐医生问候
9. 首页顶部显示数字人徐医生头像
10. 点击头像进入对话界面
11. 徐医生主动问候：
    - 早上："早上好，今天别忘了测空腹血糖哦"
    - 中午："中午好，午饭记得拍照记录"
    - 晚上："晚上好，今天的运动目标完成了吗？"

### 2.5 数据趋势预览
12. 首页底部显示"本周趋势"：
    - 血糖趋势图（简化版折线图）
    - 饮食摄入趋势（柱状图）
    - 运动天数统计
13. 点击可查看详细趋势分析

## 3. Expected Outcomes

### 用户视角
- ✅ 一屏查看今日健康数据，信息清晰
- ✅ 快捷操作入口，减少操作步骤
- ✅ 智能提醒，避免遗漏记录
- ✅ 趋势预览，了解整体健康走向

### 系统视角
- ✅ 数据聚合接口，一次请求返回所有首页数据
- ✅ 实时计算今日统计（血糖、饮食、运动）
- ✅ 缓存优化，减少数据库查询
- ✅ 响应时间 < 500ms

## 4. Constraints & Rules

### 业务规则
1. **数据时效性**：
   - 首页数据基于"今日"（00:00 - 23:59）
   - 每天 00:00 自动重置今日统计
   
2. **数据缺失处理**：
   - 如果今日无血糖记录，显示"暂无记录，点击记录"
   - 如果今日无饮食记录，显示默认值 0
   
3. **目标值来源**：
   - 饮食目标（如：2000 千卡）基于用户年龄、性别、活动量计算
   - 运动目标（如：30 分钟/天）可由用户自定义
   
4. **访客限制**：
   - 访客可查看首页，但数据较少

### 不变量（Invariants）
- **数据一致性**：首页显示的数据必须与详情页一致
- **实时性**：用户记录新数据后，首页立即刷新

### 边缘情况
1. **新用户空白首页**：
   - 无任何数据时，显示欢迎引导
   - 引导用户开始记录第一条数据
   
2. **网络故障**：
   - 数据加载失败时，显示上次缓存的数据
   - 标注"数据可能不是最新"

## 5. Evolution Hint

**全新能力**。

**未来演进**：
- P1: 支持自定义首页卡片（用户选择显示哪些卡片）
- P1: 增加血压、体重等更多健康指标
- P2: AI 健康评分（综合各项数据给出健康分数）
- P2: 家人关怀模式（家属可查看患者首页数据）

---

**关联模块**: 首页展示模块
**依赖场景**: SCN-002（血糖）、SCN-005（饮食）、SCN-006（运动）、SCN-004（数字人问候）
